var e;this.onmessage=function(t){var n=t.data;switch(n.type){case"init":return r(n.defs,n.plugins,n.scripts);case"add":return e.addFile(n.name,n.text);case"del":return e.delFile(n.name);case"req":return e.request(n.body,(function(e,t){postMessage({id:n.id,body:t,err:e&&String(e)})}));case"getFile":var i=s[n.id];return delete s[n.id],i(n.err,n.text);default:throw new Error("Unknown message type: "+n.type)}};var t=0,s={};function n(e,n){postMessage({type:"getFile",name:e,id:++t}),s[t]=n}function r(t,s,r){r&&importScripts.apply(null,r),e=new tern.Server({getFile:n,async:!0,defs:t,plugins:s})}this.console={log:function(e){postMessage({type:"debug",message:e})}};