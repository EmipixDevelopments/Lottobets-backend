!function(e){var n={zoom:{enableTouch:!1},pan:{enableTouch:!1,touchMode:"manual"},recenter:{enableTouch:!0}},t=e.plot.uiConstants.ZOOM_DISTANCE_MARGIN;function i(e){e.hooks.processOptions.push(a)}function a(e,n){var i,a,r,l,f={zoomEnable:!1,prevDistance:null,prevTapTime:0,prevPanPosition:{x:0,y:0},prevTapPosition:{x:0,y:0}},A={prevTouchedAxis:"none",currentTouchedAxis:"none",touchedAxis:null,navigationConstraint:"unconstrained",initialState:null},P=n.pan.interactive&&"manual"===n.pan.touchMode,m="smartLock"===n.pan.touchMode,y=n.pan.interactive&&(m||"smart"===n.pan.touchMode);function E(e,n){var t=e.getOptions();t.zoom.interactive&&t.zoom.enableTouch&&(n[0].addEventListener("pinchstart",a.start,!1),n[0].addEventListener("pinchdrag",a.drag,!1),n[0].addEventListener("pinchend",a.end,!1)),t.pan.interactive&&t.pan.enableTouch&&(n[0].addEventListener("panstart",i.start,!1),n[0].addEventListener("pandrag",i.drag,!1),n[0].addEventListener("panend",i.end,!1)),t.recenter.interactive&&t.recenter.enableTouch&&n[0].addEventListener("doubletap",r.recenterPlot,!1)}function b(e,n){n[0].removeEventListener("panstart",i.start),n[0].removeEventListener("pandrag",i.drag),n[0].removeEventListener("panend",i.end),n[0].removeEventListener("pinchstart",a.start),n[0].removeEventListener("pinchdrag",a.drag),n[0].removeEventListener("pinchend",a.end),n[0].removeEventListener("doubletap",r.recenterPlot)}function L(n,t,i){A.touchedAxis=u(e,n,t,A),d(A)?A.navigationConstraint="unconstrained":A.navigationConstraint="axisConstrained"}i={start:function(n){if(L(n,"pan",f),h(n,"pan",f,A),y){var t=T(n,"pan");A.initialState=e.navigationState(t.x,t.y)}},drag:function(n){if(L(n,"pan",f),y){var t=T(n,"pan");e.smartPan({x:A.initialState.startPageX-t.x,y:A.initialState.startPageY-t.y},A.initialState,A.touchedAxis,!1,m)}else P&&(e.pan({left:-g(n,"pan",f).x,top:-g(n,"pan",f).y,axes:A.touchedAxis}),x(n,"pan",f,A))},end:function(n){L(n,"pan",f),y&&e.smartPan.end(),s(n,f)&&updateprevPanPosition(n,"pan",f,A)}},a={start:function(e){l&&(clearTimeout(l),l=null),L(e,"pinch",f),p(e,f),h(e,"pinch",f,A)},drag:function(n){l||(l=setTimeout((function(){L(n,"pinch",f),e.pan({left:-g(n,"pinch",f).x,top:-g(n,"pinch",f).y,axes:A.touchedAxis}),x(n,"pinch",f,A);var i=v(n);(f.zoomEnable||Math.abs(i-f.prevDistance)>t)&&(c(e,n,f,A),f.zoomEnable=!0),l=null}),1e3/60))},end:function(e){l&&(clearTimeout(l),l=null),L(e,"pinch",f),f.prevDistance=null}},r={recenterPlot:function(n){n&&n.detail&&"touchstart"===n.detail.type&&o(e,n,f,A)}},!0!==n.pan.enableTouch&&!0!==n.zoom.enableTouch||(e.hooks.bindEvents.push(E),e.hooks.shutdown.push(b))}function o(n,t,i,a){var o;r(n,t,a),("x"===a.currentTouchedAxis&&"x"===a.prevTouchedAxis||"y"===a.currentTouchedAxis&&"y"===a.prevTouchedAxis||"none"===a.currentTouchedAxis&&"none"===a.prevTouchedAxis)&&(n.recenter({axes:a.touchedAxis}),o=a.touchedAxis?new e.Event("re-center",{detail:{axisTouched:a.touchedAxis}}):new e.Event("re-center",{detail:t}),n.getPlaceholder().trigger(o))}function r(e,n,t){var i=e.getTouchedAxis(n.detail.firstTouch.x,n.detail.firstTouch.y);void 0!==i[0]&&(t.prevTouchedAxis=i[0].direction),void 0!==(i=e.getTouchedAxis(n.detail.secondTouch.x,n.detail.secondTouch.y))[0]&&(t.touchedAxis=i,t.currentTouchedAxis=i[0].direction),d(t)&&(t.touchedAxis=null,t.prevTouchedAxis="none",t.currentTouchedAxis="none")}function c(e,n,t,i){var a=e.offset(),o={left:0,top:0},r=v(n)/t.prevDistance,c=v(n);o.left=T(n,"pinch").x-a.left,o.top=T(n,"pinch").y-a.top,e.zoom({center:o,amount:r,axes:i.touchedAxis}),t.prevDistance=c}function s(e,n){return n.zoomEnable&&1===e.detail.touches.length}function u(e,n,t,i){if("pinchstart"!==n.type)return"panstart"===n.type||"pinchend"===n.type?e.getTouchedAxis(n.detail.touches[0].pageX,n.detail.touches[0].pageY):i.touchedAxis;var a=e.getTouchedAxis(n.detail.touches[0].pageX,n.detail.touches[0].pageY),o=e.getTouchedAxis(n.detail.touches[1].pageX,n.detail.touches[1].pageY);return a.length===o.length&&a.toString()===o.toString()?a:void 0}function d(e){return!e.touchedAxis||0===e.touchedAxis.length}function p(e,n){n.prevDistance=v(e)}function h(e,n,t,i){var a,o=T(e,n);switch(i.navigationConstraint){case"unconstrained":i.touchedAxis=null,t.prevTapPosition={x:t.prevPanPosition.x,y:t.prevPanPosition.y},t.prevPanPosition={x:o.x,y:o.y};break;case"axisConstrained":a=i.touchedAxis[0].direction,i.currentTouchedAxis=a,t.prevTapPosition[a]=t.prevPanPosition[a],t.prevPanPosition[a]=o[a]}}function l(e,n,t,i){return Math.sqrt((e-t)*(e-t)+(n-i)*(n-i))}function v(e){var n=e.detail.touches[0],t=e.detail.touches[1];return l(n.pageX,n.pageY,t.pageX,t.pageY)}function x(e,n,t,i){var a=T(e,n);switch(i.navigationConstraint){case"unconstrained":t.prevPanPosition.x=a.x,t.prevPanPosition.y=a.y;break;case"axisConstrained":t.prevPanPosition[i.currentTouchedAxis]=a[i.currentTouchedAxis]}}function g(e,n,t){var i=T(e,n);return{x:i.x-t.prevPanPosition.x,y:i.y-t.prevPanPosition.y}}function T(e,n){return"pinch"===n?{x:(e.detail.touches[0].pageX+e.detail.touches[1].pageX)/2,y:(e.detail.touches[0].pageY+e.detail.touches[1].pageY)/2}:{x:e.detail.touches[0].pageX,y:e.detail.touches[0].pageY}}e.plot.plugins.push({init:i,options:n,name:"navigateTouch",version:"0.3"})}(jQuery);